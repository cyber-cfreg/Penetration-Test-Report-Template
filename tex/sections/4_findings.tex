%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%          Penetration Test Report Template           %
%                     cyber@cfreg                     %
%             https://hack.newhaven.edu/              %
%                                                     %
%                    Contributors:                    %
% TJ Balon - https://github.com/tjbalon               %
% Samuel Zurowski - https://github.com/samuelzurowski %
% Charles Barone - https://github.com/CharlesBarone   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This section is where you should supply any technical findings from your engagement.
% It is structured with summary tables followed by a summary for each vulnerability.
% These assessments are stored in tex/findings/ in their applicable directory depending upon the severity.
% tex/findings/findings_template.tex can be duplicated to easily make new assessments.
% It is recommended that you make the section label on line 2 of new assessments the same as the file name for organization purposes.
\section{Technical Findings}
\label{sec:tech}
This table shows the total number of vulnerabilities found during the penetration test engagement. The vulnerabilities are categorized based on the risk level. The risk levels were calculated using the Common Vulnerability Scoring System (CVSS) \cite{cvssdocs}.

\begin{center}
\textbf{Risk Level and Total Number of Discovered Vulnerabilities}
\end{center}

\setlength\arrayrulewidth{1.25pt}

% As of the current version of this template, the numbers in this table must manually be set
\begin{table}[h]
\renewcommand{\arraystretch}{2}
    \centering
    \begin{tabular}{|>{\large}p{11em}|>{\large}p{5em}|>{\large}p{5em}|>{\large}p{5em}|>{\large}p{6em}|}\hline
         Severity & \cellcolor{green}Low \newline (0.1-3.9) & \cellcolor{yellow}Moderate (4.0-6.9) & \cellcolor{orange}High (7.0-8.9) & \cellcolor{red}Critical (9.0-10.0)\\\hline
        Vulnerability Count& 1 & 1 & 1 & 1 \\\hline
    \end{tabular}
\end{table}

% This table provides a summary of Vulnerabilities by their Base Scores.
% https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator
% The \vuln{}{}{}{} command allows you to automatically fill these rows with proper cell colors.
% Syntax: \vuln{vulnerability name}{base score}{impact score}{exploitability score}
% Example: \vuln{Lack of MariaDB Authentication}{7.5}{5}{10}
% Ensure these rows are in the right order, highest to lowest base score (top to bottom)
% Also ensure that the tex files in tex/findings/ are included in the same order as this table
\begin{vulntable}
    \vuln{Lack of PostgreSQL Authentication}{9}{8}{10}
    \vuln{Lack of MariaDB Authentication}{7.5}{5}{10}
    \vuln{Payment Transaction Enumeration}{4.5}{4}{5}
    \vuln{ScadaBR Reflected XSS (Username)}{1.25}{1}{1.5}
\end{vulntable}


% Here you can include your vulnerability assessments
% Ensure these are in the same order as the table above
% If one of these subsections has multiple input files, put a \newpage in between the inputs.
% tex/findings/finding_template.tex is available as a template for making new assessments.
\newpage
\subsection{Critical Risk}
\input{tex/findings/critical/example_critical_finding}

\newpage
\subsection{High Risk}
\input{tex/findings/high/example_high_finding}

\newpage
\subsection{Moderate Risk}
\input{tex/findings/moderate/example_moderate_finding}

\newpage
\subsection{Low Risk}
\input{tex/findings/low/example_low_finding}

\newpage
\subsection{Informational}
\input{tex/findings/informational/example_informational_finding}
